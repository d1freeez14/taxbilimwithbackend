# –ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —É—Ä–æ–∫–æ–≤ - –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é

## üéØ –ß—Ç–æ –¥–æ–±–∞–≤–ª–µ–Ω–æ

### 1. **–û–ø–∏—Å–∞–Ω–∏–µ –∞–≤—Ç–æ—Ä–∞**
- –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `description` –¥–ª—è –∞–≤—Ç–æ—Ä–æ–≤
- –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ–± –∞–≤—Ç–æ—Ä–µ –∫—É—Ä—Å–∞

### 2. **–°—Ç–∞—Ç—É—Å –∑–∞–ø–∏—Å–∏ –∫—É—Ä—Å–∞**
- –î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `is_recorded` –≤ enrollments
- –†–∞–∑–ª–∏—á–∏–µ –º–µ–∂–¥—É –∑–∞–ø–∏—Å–∞–Ω–Ω—ã–º–∏ –∏ –∂–∏–≤—ã–º–∏ –∫—É—Ä—Å–∞–º–∏

### 3. **–°–∏—Å—Ç–µ–º–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ —É—Ä–æ–∫–æ–≤**
- –ü–æ–ª–µ `locked` –¥–ª—è —É—Ä–æ–∫–æ–≤
- –ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–µ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–µ —É—Ä–æ–∫–æ–≤
- –ü–µ—Ä–≤—ã–π —É—Ä–æ–∫ –≤—Å–µ–≥–¥–∞ —Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω
- –°–ª–µ–¥—É—é—â–∏–µ —É—Ä–æ–∫–∏ —Ä–∞–∑–±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö

### 4. **–¢–∏–ø—ã —É—Ä–æ–∫–æ–≤**
- `VIDEO` - –í–∏–¥–µ–æ—É—Ä–æ–∫–∏
- `TEST` - –¢–µ—Å—Ç—ã –∏ –∫–≤–∏–∑—ã
- `READING` - –ú–∞—Ç–µ—Ä–∏–∞–ª—ã –¥–ª—è —á—Ç–µ–Ω–∏—è
- `ASSIGNMENT` - –ó–∞–¥–∞–Ω–∏—è
- `LIVE_SESSION` - –ñ–∏–≤—ã–µ —Å–µ—Å—Å–∏–∏
- `QUIZ` - –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –∫–≤–∏–∑—ã

### 5. **–ò–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —É—Ä–æ–∫–æ–≤**
- –ü–æ–ª–µ `image` –¥–ª—è –ø—Ä–µ–≤—å—é —É—Ä–æ–∫–æ–≤
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∫–∞—Å—Ç–æ–º–Ω—ã—Ö –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

### 6. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤**
- –¢–µ—Å—Ç—ã –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∫–∞–∫ —É—Ä–æ–∫–∏
- –ü–æ–ª–µ `test_id` –¥–ª—è —Å–≤—è–∑–∏ —Å —Ç–µ—Å—Ç–∞–º–∏
- –ü–æ–ª–µ `url` –¥–ª—è –∫–∞—Å—Ç–æ–º–Ω—ã—Ö URL –Ω–∞–≤–∏–≥–∞—Ü–∏–∏

## üöÄ –ë—ã—Å—Ç—Ä—ã–π —Å—Ç–∞—Ä—Ç

### 1. –ó–∞–ø—É—Å—Ç–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é
```bash
cd backend
node src/scripts/add-lesson-features.js
```

### 2. –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–æ–≤—ã–µ API endpoints

#### –ü–æ–ª—É—á–∏—Ç—å —É—Ä–æ–∫–∏ –º–æ–¥—É–ª—è
```bash
GET /api/lessons/module/{moduleId}
```

#### –°–æ–∑–¥–∞—Ç—å —É—Ä–æ–∫
```bash
POST /api/lessons
```

#### –ü–æ–ª—É—á–∏—Ç—å —Ç–∏–ø—ã —É—Ä–æ–∫–æ–≤
```bash
GET /api/lessons/types
```

#### –°–æ–∑–¥–∞—Ç—å —Ç–µ—Å—Ç
```bash
POST /api/tests
```

## üìä –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –°–æ–∑–¥–∞–Ω–∏–µ –≤–∏–¥–µ–æ—É—Ä–æ–∫–∞
```javascript
const response = await fetch('/api/lessons', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
    'Authorization': `Bearer ${token}`
  },
  body: JSON.stringify({
    title: '–í–≤–µ–¥–µ–Ω–∏–µ –≤ –Ω–∞–ª–æ–≥–æ–æ–±–ª–æ–∂–µ–Ω–∏–µ',
    moduleId: 'module_123',
    order: 1,
    lessonType: 'VIDEO',
    videoUrl: 'https://example.com/video.mp4',
    duration: 15,
    image: '/lesson-thumbnail.jpg'
  })
});
```

### –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–∞ –∫–∞–∫ —É—Ä–æ–∫–∞
```javascript
// –°–Ω–∞—á–∞–ª–∞ —Å–æ–∑–¥–∞–µ–º —Ç–µ—Å—Ç
const testResponse = await fetch('/api/tests', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
    'Authorization': `Bearer ${token}`
  },
  body: JSON.stringify({
    title: '–¢–µ—Å—Ç –ø–æ –æ—Å–Ω–æ–≤–∞–º –Ω–∞–ª–æ–≥–æ–æ–±–ª–æ–∂–µ–Ω–∏—è',
    description: '–ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–≤–æ–∏ –∑–Ω–∞–Ω–∏—è',
    timeLimit: 30,
    passingScore: 70
  })
});

const { test } = await testResponse.json();

// –ó–∞—Ç–µ–º —Å–æ–∑–¥–∞–µ–º —É—Ä–æ–∫-—Ç–µ—Å—Ç
const lessonResponse = await fetch('/api/lessons', {
  method: 'POST',
  headers: {
    'Content-Type': 'application/json',
    'Authorization': `Bearer ${token}`
  },
  body: JSON.stringify({
    title: '–¢–µ—Å—Ç –ø–æ –æ—Å–Ω–æ–≤–∞–º –Ω–∞–ª–æ–≥–æ–æ–±–ª–æ–∂–µ–Ω–∏—è',
    moduleId: 'module_123',
    order: 2,
    lessonType: 'TEST',
    testId: test.id,
    locked: true
  })
});
```

### –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ —É—Ä–æ–∫—É
```javascript
const response = await fetch('/api/lessons/lesson_123');
const { lesson } = await response.json();

if (lesson.access.isAccessible) {
  // –£—Ä–æ–∫ –¥–æ—Å—Ç—É–ø–µ–Ω
  window.location.href = lesson.navigationUrl;
} else {
  // –£—Ä–æ–∫ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω
  alert(lesson.access.reason);
}
```

## üé® –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤–æ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç —É—Ä–æ–∫–∞
```jsx
function LessonCard({ lesson }) {
  const { access, navigationUrl, typeLabel, typeIcon } = lesson;
  
  return (
    <div className={`lesson-card ${access.isLocked ? 'locked' : ''}`}>
      <div className="lesson-icon">
        <Icon name={typeIcon} />
      </div>
      <h3>{lesson.title}</h3>
      <p>{typeLabel}</p>
      {lesson.image && (
        <img src={lesson.image} alt={lesson.title} />
      )}
      {access.isLocked && (
        <p className="locked-message">{access.reason}</p>
      )}
      <a 
        href={navigationUrl} 
        disabled={!access.isAccessible}
        className={access.isAccessible ? 'enabled' : 'disabled'}
      >
        {access.isAccessible ? '–ù–∞—á–∞—Ç—å —É—Ä–æ–∫' : '–ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–æ'}
      </a>
    </div>
  );
}
```

### –°–ø–∏—Å–æ–∫ —Ç–∏–ø–æ–≤ —É—Ä–æ–∫–æ–≤
```jsx
function LessonTypeSelector({ onTypeSelect }) {
  const [lessonTypes, setLessonTypes] = useState([]);
  
  useEffect(() => {
    fetch('/api/lessons/types')
      .then(res => res.json())
      .then(data => setLessonTypes(data.lessonTypes));
  }, []);
  
  return (
    <select onChange={(e) => onTypeSelect(e.target.value)}>
      {lessonTypes.map(type => (
        <option key={type.type} value={type.type}>
          {type.label}
        </option>
      ))}
    </select>
  );
}
```

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Ç–µ—Å—Ç–æ–≤
```jsx
function TestLesson({ lesson }) {
  const [test, setTest] = useState(null);
  
  useEffect(() => {
    if (lesson.test_id) {
      fetch(`/api/tests/${lesson.test_id}`)
        .then(res => res.json())
        .then(data => setTest(data.test));
    }
  }, [lesson.test_id]);
  
  return (
    <div className="test-lesson">
      <h3>{lesson.title}</h3>
      {test && (
        <div className="test-info">
          <p>–í—Ä–µ–º—è: {test.time_limit} –º–∏–Ω—É—Ç</p>
          <p>–ü—Ä–æ—Ö–æ–¥–Ω–æ–π –±–∞–ª–ª: {test.passing_score}%</p>
          <p>–í–æ–ø—Ä–æ—Å–æ–≤: {test.questions.length}</p>
        </div>
      )}
      <a href={lesson.navigationUrl}>
        –ü—Ä–æ–π—Ç–∏ —Ç–µ—Å—Ç
      </a>
    </div>
  );
}
```

## üîß –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ —É—Ä–æ–∫–æ–≤

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞
```javascript
// –£—Ä–æ–∫–∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –±–ª–æ–∫–∏—Ä—É—é—Ç—Å—è –µ—Å–ª–∏:
// 1. locked = true
// 2. order > 1 (–Ω–µ –ø–µ—Ä–≤—ã–π —É—Ä–æ–∫)
// 3. –ü—Ä–µ–¥—ã–¥—É—â–∏–π —É—Ä–æ–∫ –Ω–µ –∑–∞–≤–µ—Ä—à–µ–Ω

const checkLessonAccess = async (lessonId, userId) => {
  const response = await fetch(`/api/lessons/${lessonId}`);
  const { lesson } = await response.json();
  
  return lesson.access.isAccessible;
};
```

### –†—É—á–Ω–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞
```javascript
// –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å —É—Ä–æ–∫
const lockLesson = async (lessonId) => {
  await fetch(`/api/lessons/${lessonId}`, {
    method: 'PUT',
    headers: {
      'Content-Type': 'application/json',
      'Authorization': `Bearer ${token}`
    },
    body: JSON.stringify({ locked: true })
  });
};
```

## üìù –¢–∏–ø—ã —É—Ä–æ–∫–æ–≤ –∏ –∏—Ö URL

| –¢–∏–ø | URL | –û–ø–∏—Å–∞–Ω–∏–µ |
|-----|-----|----------|
| VIDEO | `/lesson/{id}/video` | –í–∏–¥–µ–æ—É—Ä–æ–∫ |
| TEST | `/lesson/{id}/test` | –¢–µ—Å—Ç |
| READING | `/lesson/{id}/reading` | –ú–∞—Ç–µ—Ä–∏–∞–ª –¥–ª—è —á—Ç–µ–Ω–∏—è |
| ASSIGNMENT | `/lesson/{id}/assignment` | –ó–∞–¥–∞–Ω–∏–µ |
| LIVE_SESSION | `/lesson/{id}/live` | –ñ–∏–≤–∞—è —Å–µ—Å—Å–∏—è |
| QUIZ | `/lesson/{id}/quiz` | –ö–≤–∏–∑ |

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

1. **–ó–∞–ø—É—Å—Ç–∏—Ç–µ –º–∏–≥—Ä–∞—Ü–∏—é** –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö –ø–æ–ª–µ–π
2. **–û–±–Ω–æ–≤–∏—Ç–µ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥** –¥–ª—è –ø–æ–¥–¥–µ—Ä–∂–∫–∏ –Ω–æ–≤—ã—Ö —Ç–∏–ø–æ–≤ —É—Ä–æ–∫–æ–≤
3. **–ù–∞—Å—Ç—Ä–æ–π—Ç–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫—É** —É—Ä–æ–∫–æ–≤ –¥–ª—è –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ–≥–æ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è
4. **–ò–Ω—Ç–µ–≥—Ä–∏—Ä—É–π—Ç–µ —Ç–µ—Å—Ç—ã** –∫–∞–∫ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Ç–∏–ø —É—Ä–æ–∫–æ–≤
5. **–î–æ–±–∞–≤—å—Ç–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è** –¥–ª—è —É—Ä–æ–∫–æ–≤

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

–ï—Å–ª–∏ —É –≤–∞—Å –≤–æ–∑–Ω–∏–∫–ª–∏ –≤–æ–ø—Ä–æ—Å—ã:
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ –º–∏–≥—Ä–∞—Ü–∏–∏
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –ø–æ–ª—è –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ –±–∞–∑—É –¥–∞–Ω–Ω—ã—Ö
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ Swagger –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é: `/api-docs`
4. –°–º. –ø–æ–¥—Ä–æ–±–Ω—É—é –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é: `LESSON_FEATURES_API.md`

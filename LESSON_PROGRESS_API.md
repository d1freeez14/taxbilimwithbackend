# üìä API –û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –ü—Ä–æ–≥—Ä–µ—Å—Å–∞ –£—Ä–æ–∫–æ–≤

## üéØ –û–±–∑–æ—Ä

–î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `is_finished` –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —É—Ä–æ–∫–∞, –∫–æ—Ç–æ—Ä–æ–µ –ø–æ–∑–≤–æ–ª—è–µ—Ç –æ—Ç—Å–ª–µ–∂–∏–≤–∞—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º. –≠—Ç–æ –ø–æ–ª–µ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –≤—ã—á–∏—Å–ª—è–µ—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –¥–∞–Ω–Ω—ã—Ö –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `lesson_progress`.

## üîó API Endpoints

### 1. **–ü–æ–ª—É—á–µ–Ω–∏–µ —É—Ä–æ–∫–æ–≤ —Å –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º**

#### –í—Å–µ —É—Ä–æ–∫–∏ —Å –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º
```http
GET /api/lessons?userId={userId}
Authorization: Bearer <token>
```

**–ü–∞—Ä–∞–º–µ—Ç—Ä—ã:**
- `userId` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ) - ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–∞

**–û—Ç–≤–µ—Ç:**
```json
{
  "lessons": [
    {
      "id": 1,
      "title": "–£—Ä–æ–∫ 1: –ß—Ç–æ —Ç–∞–∫–æ–µ –Ω–∞–ª–æ–≥–∏",
      "lesson_type": "VIDEO",
      "is_finished": true,
      "is_unlocked": false,
      "access": {
        "isAccessible": true,
        "isLocked": false,
        "type": "VIDEO",
        "label": "–í–∏–¥–µ–æ—É—Ä–æ–∫",
        "icon": "play-circle"
      },
      "navigationUrl": "/lesson/1/video",
      "typeLabel": "–í–∏–¥–µ–æ—É—Ä–æ–∫",
      "typeIcon": "play-circle"
    }
  ]
}
```

#### –£—Ä–æ–∫–∏ –º–æ–¥—É–ª—è —Å –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º
```http
GET /api/lessons/module/{moduleId}
Authorization: Bearer <token>
```

**–û—Ç–≤–µ—Ç:** –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ –≤—ã—à–µ, –Ω–æ —Ç–æ–ª—å–∫–æ —É—Ä–æ–∫–∏ —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –º–æ–¥—É–ª—è.

#### –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —É—Ä–æ–∫ —Å –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º
```http
GET /api/lessons/{id}
Authorization: Bearer <token>
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "lesson": {
    "id": 1,
    "title": "–£—Ä–æ–∫ 1: –ß—Ç–æ —Ç–∞–∫–æ–µ –Ω–∞–ª–æ–≥–∏",
    "is_finished": true,
    "is_unlocked": false,
    "access": { /* ... */ },
    "navigationUrl": "/lesson/1/video"
  }
}
```

### 2. **–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º —É—Ä–æ–∫–æ–≤**

#### –û—Ç–º–µ—Ç–∏—Ç—å —É—Ä–æ–∫ –∫–∞–∫ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–π
```http
POST /api/lessons/{id}/complete
Authorization: Bearer <token>
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "message": "Lesson marked as completed.",
  "progress": {
    "id": 1,
    "user_id": 3,
    "lesson_id": 1,
    "completed": true,
    "completed_at": "2025-09-14T19:27:47.987Z",
    "created_at": "2025-09-14T19:27:47.987Z",
    "updated_at": "2025-09-14T19:27:47.987Z"
  }
}
```

#### –û—Ç–º–µ—Ç–∏—Ç—å —É—Ä–æ–∫ –∫–∞–∫ –Ω–µ–∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–π
```http
POST /api/lessons/{id}/incomplete
Authorization: Bearer <token>
```

**–û—Ç–≤–µ—Ç:**
```json
{
  "message": "Lesson marked as incomplete.",
  "progress": {
    "id": 1,
    "user_id": 3,
    "lesson_id": 1,
    "completed": false,
    "completed_at": null,
    "created_at": "2025-09-14T19:27:47.987Z",
    "updated_at": "2025-09-14T19:27:54.136Z"
  }
}
```

## üìä –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

### –ü–æ–ª–µ `is_finished`
- **–¢–∏–ø:** `boolean`
- **–û–ø–∏—Å–∞–Ω–∏–µ:** –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç, –∑–∞–≤–µ—Ä—à–µ–Ω –ª–∏ —É—Ä–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º
- **–ó–Ω–∞—á–µ–Ω–∏—è:**
  - `true` - —É—Ä–æ–∫ –∑–∞–≤–µ—Ä—à–µ–Ω
  - `false` - —É—Ä–æ–∫ –Ω–µ –∑–∞–≤–µ—Ä—à–µ–Ω –∏–ª–∏ –Ω–µ –Ω–∞—á–∞—Ç

### –õ–æ–≥–∏–∫–∞ –≤—ã—á–∏—Å–ª–µ–Ω–∏—è
```sql
CASE 
  WHEN userId IS NULL THEN false
  ELSE COALESCE(lp.completed, false)
END as is_finished
```

–ì–¥–µ `lp.completed` - –∑–Ω–∞—á–µ–Ω–∏–µ –∏–∑ —Ç–∞–±–ª–∏—Ü—ã `lesson_progress`.

## üéØ –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### 1. –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ —É—Ä–æ–∫–∏ —Å –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
```bash
curl -H "Authorization: Bearer <token>" \
  "http://localhost:5001/api/lessons?userId=3"
```

### 2. –ü–æ–ª—É—á–∏—Ç—å —É—Ä–æ–∫–∏ –º–æ–¥—É–ª—è —Å –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º
```bash
curl -H "Authorization: Bearer <token>" \
  "http://localhost:5001/api/lessons/module/1"
```

### 3. –û—Ç–º–µ—Ç–∏—Ç—å —É—Ä–æ–∫ –∫–∞–∫ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–π
```bash
curl -X POST \
  -H "Authorization: Bearer <token>" \
  "http://localhost:5001/api/lessons/1/complete"
```

### 4. –û—Ç–º–µ—Ç–∏—Ç—å —É—Ä–æ–∫ –∫–∞–∫ –Ω–µ–∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–π
```bash
curl -X POST \
  -H "Authorization: Bearer <token>" \
  "http://localhost:5001/api/lessons/1/incomplete"
```

## üîÑ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏

### 1. **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞**
- –ü—Ä–∏ –ø—Ä–æ—Ö–æ–∂–¥–µ–Ω–∏–∏ —Ç–µ—Å—Ç–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–º–µ—á–∞–µ—Ç—Å—è —É—Ä–æ–∫ –∫–∞–∫ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–π
- –ü—Ä–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ –≤–∏–¥–µ–æ—É—Ä–æ–∫–∞ –º–æ–∂–Ω–æ –≤—Ä—É—á–Ω—É—é –æ—Ç–º–µ—Ç–∏—Ç—å –∫–∞–∫ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–π
- –ü—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –∑–∞–¥–∞–Ω–∏—è –º–æ–∂–Ω–æ –æ—Ç–º–µ—Ç–∏—Ç—å –∫–∞–∫ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–π

### 2. **–†–∞—Å—á–µ—Ç –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –∫—É—Ä—Å–∞**
- –û–±—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å –∫—É—Ä—Å–∞ —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö —É—Ä–æ–∫–æ–≤
- –ü—Ä–æ–≥—Ä–µ—Å—Å –º–æ–¥—É–ª—è —Ä–∞—Å—Å—á–∏—Ç—ã–≤–∞–µ—Ç—Å—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö —É—Ä–æ–∫–æ–≤ –≤ –º–æ–¥—É–ª–µ
- –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏

### 3. **–°–∏—Å—Ç–µ–º–∞ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ —É—Ä–æ–∫–æ–≤**
- –£—Ä–æ–∫–∏ –º–æ–≥—É—Ç –±—ã—Ç—å –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω—ã –¥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –ø—Ä–µ–¥—ã–¥—É—â–∏—Ö
- –ü–æ–ª–µ `is_unlocked` –æ–ø—Ä–µ–¥–µ–ª—è–µ—Ç –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å —É—Ä–æ–∫–∞
- –ü–æ–ª–µ `is_finished` –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç —Å—Ç–∞—Ç—É—Å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è

## üì± Frontend –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è

### 1. **–û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞**
```typescript
interface Lesson {
  id: number;
  title: string;
  is_finished: boolean;
  is_unlocked: boolean;
  lesson_type: 'VIDEO' | 'TEST' | 'READING' | 'ASSIGNMENT' | 'LIVE_SESSION' | 'QUIZ';
  // ... –¥—Ä—É–≥–∏–µ –ø–æ–ª—è
}

// –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
const LessonCard = ({ lesson }: { lesson: Lesson }) => {
  return (
    <div className="lesson-card">
      <h3>{lesson.title}</h3>
      {lesson.is_finished && (
        <span className="completed-badge">‚úì –ó–∞–≤–µ—Ä—à–µ–Ω</span>
      )}
      {!lesson.is_unlocked && (
        <span className="locked-badge">üîí –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω</span>
      )}
    </div>
  );
};
```

### 2. **API –≤—ã–∑–æ–≤—ã**
```typescript
// –û—Ç–º–µ—Ç–∏—Ç—å —É—Ä–æ–∫ –∫–∞–∫ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–π
const markLessonComplete = async (lessonId: number) => {
  const response = await fetch(`/api/lessons/${lessonId}/complete`, {
    method: 'POST',
    headers: { Authorization: `Bearer ${token}` }
  });
  return response.json();
};

// –û—Ç–º–µ—Ç–∏—Ç—å —É—Ä–æ–∫ –∫–∞–∫ –Ω–µ–∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–π
const markLessonIncomplete = async (lessonId: number) => {
  const response = await fetch(`/api/lessons/${lessonId}/incomplete`, {
    method: 'POST',
    headers: { Authorization: `Bearer ${token}` }
  });
  return response.json();
};
```

### 3. **–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞**
```typescript
// –ü–æ–ª—É—á–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å –º–æ–¥—É–ª—è
const getModuleProgress = (lessons: Lesson[]) => {
  const completed = lessons.filter(lesson => lesson.is_finished).length;
  const total = lessons.length;
  return Math.round((completed / total) * 100);
};

// –ü–æ–ª—É—á–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å –∫—É—Ä—Å–∞
const getCourseProgress = (modules: Module[]) => {
  const allLessons = modules.flatMap(module => module.lessons);
  return getModuleProgress(allLessons);
};
```

## üé® UI/UX —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏

### 1. **–í–∏–∑—É–∞–ª—å–Ω—ã–µ –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä—ã**
- ‚úÖ –ó–µ–ª–µ–Ω—ã–π —á–µ–∫–±–æ–∫—Å –¥–ª—è –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö —É—Ä–æ–∫–æ–≤
- üîí –°–µ—Ä—ã–π –∑–∞–º–æ–∫ –¥–ª—è –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —É—Ä–æ–∫–æ–≤
- ‚ñ∂Ô∏è –û–±—ã—á–Ω–∞—è –∏–∫–æ–Ω–∫–∞ –¥–ª—è –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —É—Ä–æ–∫–æ–≤
- üìä –ü—Ä–æ–≥—Ä–µ—Å—Å-–±–∞—Ä –¥–ª—è –º–æ–¥—É–ª–µ–π –∏ –∫—É—Ä—Å–æ–≤

### 2. **–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å**
- –ö–ª–∏–∫ –ø–æ —É—Ä–æ–∫—É –¥–ª—è –ø–µ—Ä–µ—Ö–æ–¥–∞ –∫ —Å–æ–¥–µ—Ä–∂–∏–º–æ–º—É
- –ö–Ω–æ–ø–∫–∞ "–û—Ç–º–µ—Ç–∏—Ç—å –∫–∞–∫ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã–π" –¥–ª—è –≤–∏–¥–µ–æ—É—Ä–æ–∫–æ–≤
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞ –ø–æ—Å–ª–µ —Ç–µ—Å—Ç–æ–≤
- –£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏–∏ —É—Ä–æ–∫–æ–≤

### 3. **–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞**
- –û–±—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å –∫—É—Ä—Å–∞ –≤ –ø—Ä–æ—Ü–µ–Ω—Ç–∞—Ö
- –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –∑–∞–≤–µ—Ä—à–µ–Ω–Ω—ã—Ö/–æ–±—â–∏—Ö —É—Ä–æ–∫–æ–≤
- –í—Ä–µ–º—è, –ø–æ—Ç—Ä–∞—á–µ–Ω–Ω–æ–µ –Ω–∞ –∫—É—Ä—Å
- –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è –∏ —Å–µ—Ä—Ç–∏—Ñ–∏–∫–∞—Ç—ã

## üöÄ –ì–æ—Ç–æ–≤–æ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!

–í—Å–µ API endpoints –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã –∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ:

‚úÖ **–î–æ–±–∞–≤–ª–µ–Ω–æ –ø–æ–ª–µ `is_finished`** –≤–æ –≤—Å–µ endpoints —É—Ä–æ–∫–æ–≤
‚úÖ **API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–µ—Å—Å–æ–º** (complete/incomplete)
‚úÖ **–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –≤—ã—á–∏—Å–ª–µ–Ω–∏–µ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞** –Ω–∞ –æ—Å–Ω–æ–≤–µ `lesson_progress`
‚úÖ **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–º–∏ —Ñ—É–Ω–∫—Ü–∏—è–º–∏** (–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞, –Ω–∞–≤–∏–≥–∞—Ü–∏—è)
‚úÖ **–ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** –∏ –ø—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –Ω–∞ —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–µ! üéâ
